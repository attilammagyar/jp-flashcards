<!DOCTYPE html>
<html lang="en">
<head>
    <title>Dump flashcards for audio</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta charset="utf-8" />
    <style>
    </style>
</head>
<body>
    <pre id="cards"></pre>
    <script type="text/javascript" src="flashcards.js"></script>
    <script type="text/javascript">
    <!--
    Flashcards.formatFurigana = function (text)
    {
        return Flashcards.quoteHtml(text);
    };

    Flashcards.formatNotes = function (text)
    {
        return text.replace(
            /\{([^|}]*)\|([^}]*)\}/g,
            "$1【$2】"
        );
    };

    Flashcards.formatJapaneseWritingAndReading = function (card_html)
    {
        var writing = card_html.replace(
                /\{([^|}]*)\|([^}]*)\}/g,
                "$1"
            ),
            pronunciation = card_html.replace(
                /\{([^|}]*)\|([^}]*)\}/g,
                "$2"
            ).replace(/ /g, "　");

        return [writing, pronunciation];
    };

    Flashcards.initialize = function (cards)
    {
        var html = [],
            settings = String(window.location.href).match(/#(.*)$/),
            cs, c, i, l, n, f;

        Flashcards.cards = cards;
        cs = Flashcards.closedRange(0, Flashcards.cards.length - 1);

        if (settings) {
            Flashcards.parseSettings(settings[1]);

            if (Flashcards.focus.length > 0) {
                cs = Flashcards.focus;
            }
        }

        for (i = 0, l = cs.length; i < l; ++i) {
            c = Flashcards.formatCard(Flashcards.cards[cs[i]]);
            n = String(cs[i] + 1) + ". ";
            f = Flashcards.formatJapaneseWritingAndReading(c[1]);
            html = html.concat([
                n + "line: " + f[0].replace(/ /g, ""),
                n + f[0].replace(/ /g, ""),
                n + f[1],
                n + c[0],
                n,
                n + "  " + c[2].replace(/\n/g, "\n" + n + "  "),
                ""
            ]);
        }

        document.getElementById("cards").innerHTML = html.join("\n");
    };
    //-->
    </script>
    <script type="text/javascript" src="cards.js"></script>
</body>
</html>
